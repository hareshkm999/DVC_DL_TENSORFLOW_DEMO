[2021-11-02 20:02:34,592: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-02 20:02:34,612: INFO: all_utils]: directory is created at data/dog
[2021-11-02 20:02:35,066: INFO: all_utils]: directory is created at data/cat
[2021-11-02 20:09:39,066: INFO: stage_01_load_save]: >>>>> stage one started
[2021-11-02 20:09:39,069: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-02 20:09:39,090: INFO: all_utils]: directory is created at data/dog
[2021-11-02 20:09:39,462: INFO: all_utils]: directory is created at data/cat
[2021-11-02 20:09:39,736: INFO: stage_01_load_save]: stage one completed! all the data are saved in local >>>>>

[2021-11-03 09:50:52,620: INFO: stage_02_prepare_base_model]: >>>>> stage two started
[2021-11-03 09:50:52,626: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-03 09:50:52,627: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-03 09:50:52,628: INFO: stage_02_prepare_base_model]: stage two completed! base model is created >>>>>

[2021-11-03 09:56:21,475: INFO: stage_02_prepare_base_model]: >>>>> stage two started
[2021-11-03 09:56:21,478: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-03 09:56:21,478: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-03 09:56:21,479: INFO: stage_02_prepare_base_model]: stage two completed! base model is created >>>>>

[2021-11-03 09:59:28,445: INFO: stage_02_prepare_base_model]: >>>>> stage two started
[2021-11-03 09:59:28,448: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-03 09:59:28,449: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-03 09:59:28,449: INFO: all_utils]: directory is created at a
[2021-11-03 09:59:28,450: INFO: all_utils]: directory is created at r
[2021-11-03 09:59:28,451: INFO: all_utils]: directory is created at t
[2021-11-03 09:59:28,451: INFO: all_utils]: directory is created at i
[2021-11-03 09:59:28,451: INFO: all_utils]: directory is created at f
[2021-11-03 09:59:28,452: INFO: all_utils]: directory is created at a
[2021-11-03 09:59:28,453: INFO: all_utils]: directory is created at c
[2021-11-03 09:59:28,453: INFO: all_utils]: directory is created at t
[2021-11-03 09:59:28,454: INFO: all_utils]: directory is created at s
[2021-11-03 09:59:28,454: INFO: all_utils]: directory is created at \
[2021-11-03 09:59:28,454: INFO: all_utils]: directory is created at b
[2021-11-03 09:59:28,455: INFO: all_utils]: directory is created at a
[2021-11-03 09:59:28,455: INFO: all_utils]: directory is created at s
[2021-11-03 09:59:28,456: INFO: all_utils]: directory is created at e
[2021-11-03 09:59:28,456: INFO: all_utils]: directory is created at _
[2021-11-03 09:59:28,457: INFO: all_utils]: directory is created at m
[2021-11-03 09:59:28,457: INFO: all_utils]: directory is created at o
[2021-11-03 09:59:28,458: INFO: all_utils]: directory is created at d
[2021-11-03 09:59:28,458: INFO: all_utils]: directory is created at e
[2021-11-03 09:59:28,458: INFO: all_utils]: directory is created at l
[2021-11-03 09:59:28,459: INFO: stage_02_prepare_base_model]: stage two completed! base model is created >>>>>

[2021-11-03 12:51:14,924: INFO: stage_02_prepare_base_model]: >>>>> stage two started
[2021-11-03 12:51:14,926: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-03 12:51:14,928: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-03 12:51:14,928: INFO: all_utils]: directory is created at a
[2021-11-03 12:51:14,929: INFO: all_utils]: directory is created at r
[2021-11-03 12:51:14,929: INFO: all_utils]: directory is created at t
[2021-11-03 12:51:14,929: INFO: all_utils]: directory is created at i
[2021-11-03 12:51:14,930: INFO: all_utils]: directory is created at f
[2021-11-03 12:51:14,930: INFO: all_utils]: directory is created at a
[2021-11-03 12:51:14,931: INFO: all_utils]: directory is created at c
[2021-11-03 12:51:14,931: INFO: all_utils]: directory is created at t
[2021-11-03 12:51:14,932: INFO: all_utils]: directory is created at s
[2021-11-03 12:51:14,932: INFO: all_utils]: directory is created at \
[2021-11-03 12:51:14,932: INFO: all_utils]: directory is created at b
[2021-11-03 12:51:14,933: INFO: all_utils]: directory is created at a
[2021-11-03 12:51:14,933: INFO: all_utils]: directory is created at s
[2021-11-03 12:51:14,934: INFO: all_utils]: directory is created at e
[2021-11-03 12:51:14,934: INFO: all_utils]: directory is created at _
[2021-11-03 12:51:14,935: INFO: all_utils]: directory is created at m
[2021-11-03 12:51:14,935: INFO: all_utils]: directory is created at o
[2021-11-03 12:51:14,936: INFO: all_utils]: directory is created at d
[2021-11-03 12:51:14,936: INFO: all_utils]: directory is created at e
[2021-11-03 12:51:14,937: INFO: all_utils]: directory is created at l
[2021-11-03 12:52:08,471: WARNING: saving_utils]: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
[2021-11-03 12:52:08,794: INFO: models]: VGG16 base model saved at artifacts\base_model\VGG16_base_model.h5
[2021-11-03 12:52:08,872: INFO: models]: custom model is compiled and ready to be trained
[2021-11-03 12:52:08,919: ERROR: stage_02_prepare_base_model]: name 'io' is not defined
Traceback (most recent call last):
  File "src/stage_02_prepare_base_model.py", line 71, in <module>
    prepare_base_model(config_path=parsed_args.config, params_path=parsed_args.params)
  File "src/stage_02_prepare_base_model.py", line 55, in prepare_base_model
    logging.info(f"full model summary: \n{_log_model_summary(full_model)}")
  File "src/stage_02_prepare_base_model.py", line 50, in _log_model_summary
    with io.StringIO() as stream:
NameError: name 'io' is not defined
[2021-11-03 12:54:15,743: INFO: stage_02_prepare_base_model]: >>>>> stage two started
[2021-11-03 12:54:15,745: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-03 12:54:15,747: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-03 12:54:15,747: INFO: all_utils]: directory is created at artifacts\base_model
[2021-11-03 12:54:16,696: WARNING: saving_utils]: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
[2021-11-03 12:54:16,963: INFO: models]: VGG16 base model saved at artifacts\base_model\VGG16_base_model.h5
[2021-11-03 12:54:16,991: INFO: models]: custom model is compiled and ready to be trained
[2021-11-03 12:54:17,019: INFO: stage_02_prepare_base_model]: full model summary: 
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 224, 224, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 224, 224, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 224, 224, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 112, 112, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 112, 112, 128)     73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 112, 112, 128)     147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 56, 56, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 56, 56, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 28, 28, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 28, 28, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 14, 14, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 7, 7, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 25088)             0         
_________________________________________________________________
dense (Dense)                (None, 2)                 50178     
=================================================================
Total params: 14,764,866
Trainable params: 50,178
Non-trainable params: 14,714,688
_________________________________________________________________

[2021-11-03 12:54:17,144: INFO: stage_02_prepare_base_model]: stage two completed! base model is created >>>>>

[2021-11-05 07:58:18,945: INFO: stage_02_prepare_base_model]: >>>>> stage two started
[2021-11-05 07:58:18,961: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-05 07:58:18,961: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-05 07:58:18,961: INFO: all_utils]: directory is created at artifacts\base_model
[2021-11-05 07:58:40,726: WARNING: saving_utils]: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
[2021-11-05 07:58:41,996: INFO: models]: VGG16 base model saved at artifacts\base_model\VGG16_base_model.h5
[2021-11-05 07:58:42,152: INFO: models]: custom model is compiled and ready to be trained
[2021-11-05 07:58:42,200: INFO: stage_02_prepare_base_model]: full model summary: 
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 224, 224, 3)]     0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 224, 224, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 224, 224, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 112, 112, 64)      0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 112, 112, 128)     73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 112, 112, 128)     147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 56, 56, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 56, 56, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 56, 56, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 28, 28, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 28, 28, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 28, 28, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 14, 14, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 14, 14, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 7, 7, 512)         0         
_________________________________________________________________
flatten (Flatten)            (None, 25088)             0         
_________________________________________________________________
dense (Dense)                (None, 2)                 50178     
=================================================================
Total params: 14,764,866
Trainable params: 50,178
Non-trainable params: 14,714,688
_________________________________________________________________

[2021-11-05 07:58:48,533: INFO: stage_02_prepare_base_model]: stage two completed! base model is created >>>>>

[2021-11-05 08:58:45,744: INFO: stage_03_prepare_callbacks]: >>>>> stage three started
[2021-11-05 08:58:45,744: INFO: stage_03_prepare_callbacks]: stage three completed! callbacks are prepared and binaries created >>>>>

[2021-11-05 12:19:36,561: INFO: stage_03_prepare_callbacks]: >>>>> stage three started
[2021-11-05 12:19:36,565: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-05 12:19:36,567: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-05 12:19:36,568: INFO: all_utils]: directory is created at artifacts\tensorboard_log_dir
[2021-11-05 12:19:36,685: INFO: all_utils]: directory is created at artifacts\checkpoints
[2021-11-05 12:19:36,686: INFO: all_utils]: directory is created at artifacts\callbacks
[2021-11-05 12:19:43,255: INFO: callbacks]: tensorboard callback is being saved at artifacts\callbacks\tensorboard_cb.cb
[2021-11-05 12:19:43,255: ERROR: stage_03_prepare_callbacks]: module 'keras.api._v2.keras.callbacks' has no attribute 'Modelcheckpoint'
Traceback (most recent call last):
  File "src/stage_03_prepare_callbacks.py", line 51, in <module>
    prepare_callbacks(config_path=parsed_args.config, params_path=parsed_args.params)
  File "src/stage_03_prepare_callbacks.py", line 33, in prepare_callbacks
    create_and_save_checkpoint_callbacks(callbacks_dir, checkpoint_dir)
  File "c:\users\hares\desktop\mlops\dvc_dl_tensorflow_demo\src\utils\callbacks.py", line 24, in create_and_save_checkpoint_callbacks
    checkpoint_callback = tf.keras.callbacks.Modelcheckpoint(
AttributeError: module 'keras.api._v2.keras.callbacks' has no attribute 'Modelcheckpoint'
[2021-11-05 12:22:08,835: INFO: stage_03_prepare_callbacks]: >>>>> stage three started
[2021-11-05 12:22:08,835: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-05 12:22:08,835: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-05 12:22:08,835: INFO: all_utils]: directory is created at artifacts\tensorboard_log_dir
[2021-11-05 12:22:08,835: INFO: all_utils]: directory is created at artifacts\checkpoints
[2021-11-05 12:22:08,835: INFO: all_utils]: directory is created at artifacts\callbacks
[2021-11-05 12:22:09,360: INFO: callbacks]: tensorboard callback is being saved at artifacts\callbacks\tensorboard_cb.cb
[2021-11-05 12:22:09,366: INFO: callbacks]: checkpoint callback is being saved at artifacts\callbacks\checkpoint_cb.cb
[2021-11-05 12:22:09,366: INFO: stage_03_prepare_callbacks]: stage three completed! callbacks are prepared and binaries created >>>>>

[2021-11-05 13:21:29,469: INFO: stage_04_train]: >>>>> stage four started
[2021-11-05 13:21:29,469: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-05 13:21:29,469: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-05 13:21:29,469: INFO: stage_04_train]: stage four completed! training compleated >>>>>

[2021-11-05 14:11:57,752: INFO: stage_04_train]: >>>>> stage four started
[2021-11-05 14:11:57,754: INFO: all_utils]: yaml file: config/config.yaml loaded successfully
[2021-11-05 14:11:57,756: INFO: all_utils]: yaml file: params.yaml loaded successfully
[2021-11-05 14:11:57,756: INFO: all_utils]: directory is created at artifacts\model
[2021-11-05 14:11:57,757: INFO: stage_04_train]: stage four completed! training compleated >>>>>

